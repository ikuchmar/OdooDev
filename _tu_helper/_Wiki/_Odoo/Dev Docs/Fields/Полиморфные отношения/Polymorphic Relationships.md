=====================================================
Polymorphic Relationships
=====================================================
Для организации связи одной модели lines с несколькими моделями,
которые будут использовать модель lines как табличную часть.

=====================================================
В модели lines можно создать поле res_model типа Char,
в котором будет храниться имя модели, к которой относится табличная часть.

Также необходимо создать поле res_id типа Integer, которое будет хранить идентификатор записи в связанной модели.

class Lines(models.Model):
    _name = 'lines'

    res_model = fields.Char('Related Model', required=True)
    res_id = fields.Integer('Related ID', required=True)

    name = fields.Char('Name')
    value = fields.Float('Value')


=====================================================
в моделях, которые будут использовать lines в качестве табличной части, необходимо:

1. создать поле типа One2many, которое будет ссылаться на lines:
2. настроить в модели lines полиморфную связь с моделями, которые будут использовать lines в качестве табличной части.
 (использовать поля res_model и res_id)

Теперь при создании записи в модели example.model необходимо указать связанные записи в модели lines через поле line_ids:

class ExampleModel(models.Model):
    _name = 'example.model'

    line_ids = fields.One2many('lines', 'res_id', domain=[('res_model', '=', 'example.model')])

    @api.model
    def create(self, vals):
        lines = vals.pop('line_ids', [])
        example_model = super().create(vals)
        for line in lines:
            line['res_model'] = 'example.model'
            line['res_id'] = example_model.id
            self.env['lines'].create(line)
        return example_model


=====================================================
При чтении записи в модели example.model можно получить связанные записи в модели lines с помощью поля line_ids.
для получения записей в модели lines для записи в модели example.model с идентификатором example_id, можно использовать следующий код:

lines = self.env['lines'].search([('res_model', '=', 'example.model'), ('res_id', '=', example_id)])


=====================================================
lines = vals.pop('line_ids', [])
Эта строка кода используется для извлечения значений, связанных с ключом "line_ids", из словаря "vals",
а затем присваивает эти значения переменной "lines", которая используется для создания записей в связанных моделях.

Обычно в Odoo создание записей в связанных моделях выполняется через создание или обновление записей в основной модели.
Значения, связанные с моделями, которые используют основную модель как табличную часть, передаются через словарь "vals" в формате,
 где каждая запись представлена словарем.
 Это значит, что каждый элемент в "vals" может содержать ключ "line_ids" с соответствующим списком значений для создания записей в связанных моделях.

Чтобы создать записи в связанных моделях, эти значения должны быть извлечены из словаря "vals" и сохранены в отдельной переменной.

Функция create() потом будет использоваться для создания записей в связанных моделях на основе значений, сохраненных в переменной "lines".

В данной строке кода, значение, связанное с ключом "line_ids", удаляется из словаря "vals" с помощью метода pop(). Метод pop() возвращает значение, связанное с указанным ключом, и удаляет его из словаря. Значение, которое возвращается методом pop(), затем присваивается переменной "lines", которая используется для создания записей в связанных моделях.


